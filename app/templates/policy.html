<html>
  <head>
    <link rel="shortcut icon" href="{{ url_for('static', filename='files/cpapi.ico') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static',filename='styles/cpapi.css') }}?v={{config['version']}}">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.6-rc.0/css/select2.min.css" rel="stylesheet" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.6-rc.0/js/select2.min.js"></script>
    <script src="{{url_for('static', filename='js/policy.js')}}"></script>
  </head>
    <body>
      <div class="main-navigation">
        {%- include 'postlognav.html' -%}
      </div>
      <div class="content">
        <div class="policyform">
          <label><b>Rulebase</b></label>
          <select id="layer" name="layer">
          {%- for layer in alllayers -%}
            {%- if layer[1] == lastlayer -%}
            <option value="{{ layer[1] }}" selected>{{ layer[0] }}</option>
            {%- else -%}
            <option value="{{ layer[1] }}">{{ layer[0] }}</option>
            {%- endif -%}
          {%- endfor -%}
          </select>
          <button onclick="showpolicyPost()">Submit</button>
          <br><br>
          <b><span id="policyprogress"></span></b>
        </div>
        <br>
        <div class="rulesearch">
          <label><b>Search Rulebase</b></label>
          <input id="searchstring" type="text" name="search" onchange="rulesearch()">
        </div>
        <br>
        <div id="policyfeedback" class="policyfeedback">
        </div>
        <div id="ruletable" class="ruletable">
          <table>
            <col width="1%">
            <col width="12%">
            <col width="20%">
            <col width="20%">
            <col width="15%">
            <col width="8%">
            <col width="8%">
            <col width="15%">
            <col width="1%">
            <thead>
              <th>Number</th>
              <th>Name</th>
              <th>Source</th>
              <th>Destination</th>
              <th>Service</th>
              <th>Action</th>
              <th>Track</th>
              <th>Target</th>
              <th>Edit</th>
            </thead>
              <tr class="rulebreak">
                <td colspan="9"><b>Add Rule</b></td>
              </tr>
              <form action="" method="post">
                <tr>
                  <td><input type="text" name="position" value="1"></td>
                  <td><input type="text" name="name"></td>
                  <td>
                    <select multiple="multiple" type="text" name="source">
                      {%- for object in allobjects['networkobjects'] -%}
                      <option value="{{object[0]}}">{{ object[1] }} - {{ object[2] }}</option>
                      {%- endfor -%}
                    </select>
                  </td>
                  <td>
                    <select multiple="multiple" type="text" name="destination">
                      {%- for object in allobjects['networkobjects'] -%}
                      <option value="{{object[0]}}">{{ object[1] }} - {{ object[2] }}</option>
                      {%- endfor -%}
                    </select>
                  </td>
                  <td>
                    <select multiple="multiple" type="text" name="service">
                      {%- for object in allobjects['serviceobjects'] -%}
                      <option value="{{object[0]}}">{{ object[1] }} - {{ object[2] }}</option>
                      {%- endfor -%}
                    </select>
                  </td>
                  <td>
                    <select type="text" name="action">
                      <option value="drop">Drop</option>
                      <option value="accept">Accept</option>
                    </select>
                  </td>
                  <td>
                    <select type="text" name="track">
                      <option value="none">None</option>
                      <option value="log">Log</option>
                      <option value="extended log">Extended</option>
                      <option value="detailed log">Detailed</option>
                    </select>
                  </td>
                  <td>
                    <select multiple="multiple" name="install-on">
                      {%- for object in allobjects['targets'] -%}
                      <option value="{{object[0]}}">{{ object[1] }} - {{ object[2] }}</option>
                      {%- endfor -%}
                    </select>
                  </td>
                  <td><input type="image" name="add" value="add" src="{{ url_for('static', filename='files/save.png') }}"></td>
                <tr>
              </form>
            <tr class="rulebreak">
              <td colspan="9"><b>Policy Rules</b></td>
            </tr>
            <tbody id="tbody">
            </tbody>
          </table>
        </div>
      </div>
    </body>
</html>
